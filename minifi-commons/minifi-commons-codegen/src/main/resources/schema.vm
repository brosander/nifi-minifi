/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package $class.package;

#foreach($import in $class.classImports)
import $import;
#end

#set($underscoreNames = $util.newMap())
#set($getterNames = $util.newMap())
#set($underscoreNames[$class.key] = $util.calculateUnderscoreName($class.name))
#foreach($field in $class.fields)
#set($underscoreNames[$field.name] = $util.calculateUnderscoreName($field.name))
#set($getterNames[$field.name] = $util.calculateGetterName($field.name))
#end

//CHECKSTYLE:LineLength:OFF
public#if(!$class.concrete) abstract#end class #if(!$class.concrete) Abstract#end$class.name extends $class.extends #if($class.implementsString)implements $class.implementsString #end{
    public static final String ${underscoreNames[$class.key]}_KEY = "$class.key";
#foreach($field in $class.fields)
    public static final String ${underscoreNames[$field.name]}_KEY = "$field.key";
#end

#foreach($field in $class.fields)
#if ($field.hasDefault())
    public static final $field.type ${underscoreNames[$field.name]}_DEFAULT = $field.defaultLiteral;
#end
#end

#foreach($field in $class.fields)
    private $field.type ${field.name}#if($field.hasDefault()) = ${underscoreNames[$field.name]}_DEFAULT#end;
#end

    public #if(!$class.concrete) Abstract#end${class.name}() {
#foreach($field in $class.fields)
#if ($class.isSchema($field.type))
        $field.name = new ${field.type}();
#end
#end
    }

    public #if(!$class.concrete) Abstract#end${class.name}(Map map) {
#foreach($field in $class.fields)
#if ($field.type.equals("int"))
#set($extraConvert = ".intValue()")
#elseif ($field.type.equals("long"))
#set($extraConvert = ".longValue()")
#else
#set($extraConvert = "")
#end
#if ($class.isSchema($field.type))
        $field.name = getMapAsType(map, ${underscoreNames[$field.name]}_KEY, ${field.mapType}.class, ${underscoreNames[$class.key]}_KEY, $field.required);
        addIssuesIfNotNull($field.name);
#elseif ($field.enum)
#if ($field.hasDefault())
        String ${field.name}String = getOptionalKeyAsType(map, ${underscoreNames[$field.name]}_KEY, String.class, ${underscoreNames[$class.key]}_KEY, ${underscoreNames[$field.name]}_DEFAULT);
#else
        String ${field.name}String = getRequiredKeyAsType(map, ${underscoreNames[$field.name]}_KEY, String.class, ${underscoreNames[$class.key]}_KEY);
#end
        if (${field.name}String != null) {
            try {
                $field.name = ${field.type}.valueOf(${field.name}String);
            } catch (IllegalArgumentException e) {
                addValidationIssue(${underscoreNames[$field.name]}_KEY, ${underscoreNames[$class.key]}_KEY, "it is not a valid ${field.type}");
            }
        }
#else
#if ($field.hasDefault())
        $field.name = getOptionalKeyAsType(map, ${underscoreNames[$field.name]}_KEY, ${field.mapType}.class, ${underscoreNames[$class.key]}_KEY, ${underscoreNames[$field.name]}_DEFAULT)$extraConvert;
#else
        $field.name = getRequiredKeyAsType(map, ${underscoreNames[$field.name]}_KEY, ${field.mapType}.class, ${underscoreNames[$class.key]}_KEY)$extraConvert;
#end
#end
#end
#if ($class.additionalValidator)

        new ${class.additionalValidator}().validate(this);
#end
    }

#if ($class.writable)
    @Override
    public Map<String, Object> toMap() {
        Map<String, Object> result = mapSupplier.get();
#foreach($field in $class.fields)
#if ($field.enum)
        if ($field.name != null) {
            result.put(${underscoreNames[$field.name]}_KEY, ${field.name}.name());
        }
#elseif ($class.isSchema($field.type))
        putIfNotNull(result, ${underscoreNames[$field.name]}_KEY, $field.name);
#else
        result.put(${underscoreNames[$field.name]}_KEY, $field.name);
#end
#end
        return result;
    }
#foreach($field in $class.fields)

    public $field.type ${getterNames[$field.name]}() {
        return $field.name;
    }
#end
#end
}
//CHECKSTYLE:LineLength:ON